<div class="flex flex-1 flex-row" *ngIf="{activeTab : activeTab | async, 
        totalRecords: totalRecords | async, 
        groupCenturies : groupCenturies | async, 
        activeDate : activeDate | async, 
        activeLocation : activeLocation | async,
        activeType : activeType | async,
        activeFile : activeFile | async, 
        groupLocations : groupLocations | async,
        groupType : groupTypes | async,
        groupLanguage : groupLanguages | async,
        groupMaterial : groupMaterial | async,
        groupObjectTypes : groupObjectTypes | async} as text">

        <div id="left-bar" class="flex flex-column">
            <p-tabView *ngIf="!text.activeFile" class="normal-tabview">
        
                <p-tabPanel header="Categories" [selected]="text.activeTab != 'search'">
        
                    <ul class="home-menu">
        
                        <a *ngFor="let filter of allowedFilters" (click)="getAllData()" [href]="'/texts?filter='+filter"
                            class="categories no-underline" routerLink="./" [queryParams]="{filter : filter}" routerLinkActive="active"
                            [routerLinkActiveOptions]="{exact : false}">
                            <li class="pl-4 flex align-items-center" *ngIf="filter != 'search'">
                                <span class="icon"></span>
                                <span class="route flex-1">{{filter | titlecase}}</span>
                            </li>
                        </a>
                    </ul>
                </p-tabPanel>
        
                <p-tabPanel class="flex flex-column flex-1" header="Simple search" [selected]="text.activeTab == 'search'">

                    <form id="search-form" class="flex flex-column flex-auto h-full" [formGroup]="searchForm">


                        <p-panel header="Full Text" [toggleable]="false">
                            <div class="flex-column start">
                                <div id="text-radio-button" class="pt-2 p-inputgroup">
                                    <input (focus)="markAsTouched()" id="float-input" type="text"
                                        [placeholder]="!searchForm.get('greekMode')?.value  ? 'Eg: legù' : 'Eg: λεγϋ'"
                                        name="word" formControlName="word" pInputText /> 
                                    
                                </div>
                            
                            </div>
                        </p-panel>

                        <p-panel class="cursor-pointer" header="Title and Id's" [toggleable]="true" [collapsed]="true" [toggler]="'header'">
                            <div class="flex-column start">
                                <div id="text-radio-button" class="pt-2 p-inputgroup">
                                    <input id="float-input" type="text" 
                                        (focus)="markAsTouched()"
                                        placeholder="Enter title..."
                                        formControlName="title" pInputText /> 
                                    <!-- <p-toggleButton formControlName="titleExactMatch" onIcon="exact" offIcon="contains"
                                        [pTooltip]="searchForm.get('titleExactMatch')?.value ? 'Exact match: true' : 'Exact match: false'"
                                        tooltipPosition="right"></p-toggleButton> -->
                                </div>

                                <div id="text-radio-button" class="pt-2 p-inputgroup">
                                    <input (focus)="markAsTouched()" id="float-input" type="text"
                                        placeholder="Enter ID..."
                                        formControlName="id" pInputText /> 
                                    <!-- <p-toggleButton formControlName="idExactMatch" onIcon="exact" offIcon="contains"
                                        [pTooltip]="searchForm.get('idExactMatch')?.value ? 'Exact match: true' : 'Exact match: false'"
                                        tooltipPosition="right"></p-toggleButton> -->
                                </div>
                               <!--  <div class="mt-4">
                                    <p-selectButton [options]="searchOptions" formControlName="searchMode"></p-selectButton>
                                </div> -->
                            </div>
                        </p-panel>

                        <p-panel class="cursor-pointer" header="Date" [toggleable]="true" [collapsed]="true" [toggler]="'header'">
                            <div class="flex pt-3">
                                <p-checkbox [(ngModel)]="isActiveInterval" [binary]="true" label="Interval" [ngModelOptions]="{standalone: true}"></p-checkbox>
                            </div>
                            <div class="flex pt-3">
                                <p-dropdown (onClear)="clearDates()" appendTo="body" [showClear]="true" class="flex-auto" [options]="(text.groupCenturies) || []" formControlName="dateOfOriginNotBefore"
                                    optionValue="century" optionLabel="label" placeholder="Eg: 6th century BC">
                                    <ng-template let-date pTemplate="item">
                                        <div class="century-item">
                                            <span class="counter">{{date.label}}</span>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>

                            <div class="flex pt-3" *ngIf="isActiveInterval">
                                <p-dropdown [disabled]="searchForm.get('dateOfOriginNotBefore')?.value == null" appendTo="body"  [showClear]="true" class="flex-auto" [options]="(text.groupCenturies) || []" formControlName="dateOfOriginNotAfter"
                                    optionValue="century" optionLabel="label" placeholder="Eg: 6th century BC">
                                    <ng-template let-date pTemplate="item">
                                        <div class="century-item">
                                            <span class="counter">{{date.label}}</span>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>
                        </p-panel>

                        <p-panel class="cursor-pointer" header="Location" [toggleable]="true" [collapsed]="true" [toggler]="'header'">

                            <p-autoComplete 
                                            (onClear)="clearLocation()"
                                            (onSelect)="handleAutocompleteFilter($event)"
                                            [suggestions]="(searchLocations | async) || []" 
                                            (completeMethod)="autocomplete$.next($event)"
                                            field="ancientPlaceLabel"
                                            placeholder="Eg: Samnium"
                                            [showClear]="true">

                                            <ng-template let-item pTemplate="item">
                                                <div>{{item.ancientPlaceLabel}}</div>
                                                <sub>{{item.modernPlaceLabel}}</sub>
                                            </ng-template>
                            </p-autoComplete>

                        </p-panel>


                        <p-panel class="cursor-pointer" header="Language" [toggleable]="true" [collapsed]="true" [toggler]="'header'">
                            
                            <div class="flex pt-3">
                                <p-dropdown appendTo="body" [showClear]="true" class="flex-auto" [options]="(text.groupLanguage) || []" formControlName="language"
                                    optionValue="language" optionLabel="language" placeholder="Select language...">
                                    <ng-template let-item pTemplate="item">
                                        <div class="language-item">
                                            <span class="counter">{{item.language}} - {{item.count}}</span>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>

            
                        </p-panel>

                        <p-panel class="cursor-pointer" header="Inscription Types" [toggleable]="true" [collapsed]="true" [toggler]="'header'">
                            
                            <div class="flex pt-3">
                                <p-dropdown appendTo="body" [showClear]="true" class="flex-auto" [options]="(text.groupType) || []" formControlName="inscriptionType"
                                    optionValue="inscriptionType" optionLabel="inscriptionType" placeholder="Select inscription type...">
                                    <ng-template let-inscriptionType pTemplate="item">
                                        <div class="language-item">
                                            <span class="counter">{{inscriptionType.inscriptionType}}</span>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>

            
                        </p-panel>


                        <p-panel class="cursor-pointer" header="Object Types" [toggleable]="true" [collapsed]="true" [toggler]="'header'">
                            
                            <div class="flex pt-3">
                                <p-dropdown [appendTo]="'body'" [showClear]="true" class="flex-auto" [options]="(text.groupObjectTypes) || []" formControlName="objectType"
                                    optionValue="objectType" optionLabel="objectType" placeholder="Select object type...">
                                    <ng-template let-objectType pTemplate="item">
                                        <div class="language-item">
                                            <span class="counter">{{objectType.objectType}}</span>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>

            
                        </p-panel>

                        <p-panel class="cursor-pointer" header="Materials" [toggleable]="true" [collapsed]="true" [toggler]="'header'">
                            
                            <div class="flex pt-3">
                                <p-dropdown appendTo="body" [showClear]="true" class="flex-auto" [options]="(text.groupMaterial) || []" formControlName="material"
                                    optionValue="material" optionLabel="material" placeholder="Select material...">
                                    <ng-template let-materials pTemplate="item">
                                        <div class="language-item">
                                            <span class="counter">{{materials.material}}</span>
                                        </div>
                                    </ng-template>
                                </p-dropdown>
                            </div>

            
                        </p-panel>


                        <div class="flex pt-3 mb-0 mt-auto search-button-div sticky bottom-0">
                            <button pButton 
                                (click)="resetFields()"
                                type="button"
                                label="Reset fields" 
                                class="p-button-danger border-noround flex-1"
                                icon="fa-solid fa-times" 
                                iconPos="left">
                            </button>
                            <!-- <button pButton 
                                    type="submit"
                                    label="Search" 
                                    class="p-button-secondary border-noround flex-1"
                                    icon="fa-solid fa-search" 
                                    iconPos="right">
                            </button> -->
                        </div>

    
                    </form>
                </p-tabPanel>
        
            </p-tabView>

            <ul class="home-menu" *ngIf="text.activeFile">
        
                
                <!-- SHOW XML -->
                <a  class="categories no-underline">
                    <li class="pl-4 flex align-items-center" (click)="showModal()">
                        <span class="icon"></span>
                        <span class="route flex-1">Show XML</span>

                       
                    </li>

                    <p-dialog [appendTo]="'body'" [autoZIndex]="true" [header]="text.activeFile" [(visible)]="displayModal" [modal]="true" [style]="{width: '80vw'}"
                             [draggable]="false" [resizable]="false" (onHide)="hideModal()">

                             <pre><code [highlight]="code" [lang]="'xml'" *ngIf="code != ''"></code></pre>
                             <span *ngIf="code == ''">Loading...</span>
                    </p-dialog>
                </a>
                <!-- PRINT/PDF ? -->
                <a  class="categories no-underline">
                    <li class="pl-4 flex align-items-center" (click)="printDocument()">
                        <span class="icon"></span>
                        <span class="route flex-1">Print/Save PDF</span>
                    </li>
                </a>

                <!-- SHOW HIDE RESTORATIONS -->
                <a  class="categories no-underline" (click)="showHideRestorations()">
                    <li class="pl-4 flex align-items-center">
                        <span class="icon"></span>
                        <span class="route flex-1">Show/Hide restorations</span>
                    </li>
                </a>
            </ul>
        
        </div>
        
        <div id="texts-container" class="flex flex-column flex-1">
            
            <!-- TEXT FILTER ALL -->
            <div id="filter-texts-container" class="flex flex-column text-container-top" *ngIf="text.activeTab == 'all' || text.activeTab == 'search'">
                <div class="flex flex-row align-items-center horizontal-list m-3 text-center">
                    <h2 class="flex-1 loading" *ngIf="!text.totalRecords && !somethingWrong && text.totalRecords != 0">Loading <span>.</span><span>.</span><span>.</span>
                    </h2>
                    <h2 class="flex-1" *ngIf="somethingWrong">Ops!</h2>
                    <h2 class="flex-1" *ngIf="text.totalRecords || text.totalRecords == 0 && !somethingWrong"><span class="red">{{text.totalRecords}} </span>texts found
                    </h2>
                </div>
        
        
            </div>
        
            
            <!-- TEXT FILTER DATE -->
            <div id="filter-date-container" class="flex flex-column text-container-top" *ngIf="text.activeTab == 'date'">
                <div class="flex flex-row horizontal-list m-3 text-container-top">
                    <h2 class="loading text-center flex-1 flex align-items-center justify-content-center"
                        *ngIf="!text.groupCenturies">Loading <span>.</span><span>.</span><span>.</span></h2>
        
                    <ul class="flex-wrap align-items-center" *ngIf="text.groupCenturies">
        
                        <li *ngFor="let item of text.groupCenturies" [class.active]="text.activeDate == item.century"
                            (click)="filterByDate(item.century)"
                            class="my-2 mr-2 align-items-center border-round-2xl century-list-element" routerLink="./"
                            [queryParams]="{filter: 'date', date: item.century}">
                            <p-badge class="p-2 pr-0" value="{{item.count}}"></p-badge>
                            <a class="no-underline font-bold">{{item.century | centuryPipe}}</a>
                        </li>
        
        
                    </ul>
                </div>
            </div>
            

            <!-- TEXT FILTER LOCATION -->
            <div id="filter-location-container" class="flex flex-column" *ngIf="text.activeTab == 'location'" 
                (mousedown)="onMouseDown($event)" 
                (mousemove)="onMouseMove($event)" 
                (mouseup)="onMouseUp()"
                [ngClass]="{'dragging': isDragging}">
        
                <div class="flex flex-row horizontal-list resizer m-3 text-container-top justify-content-between">
        
                    <h2 class="loading text-center flex-1 flex align-items-center justify-content-center"
                        *ngIf="!text.groupLocations">Loading <span>.</span><span>.</span><span>.</span>
                    </h2>
                    <ul class="flex-wrap align-items-center" *ngIf="text.groupLocations">
                        <li *ngFor="let item of text.groupLocations"
                            class="my-2 mr-2 align-items-center border-round-2xl century-list-element" routerLink="./"
                            [class.active]="(text.activeLocation == item.ancientPlaceId)"
                            [queryParams]="{filter: 'location', place: ((item.ancientPlaceId == '' || item.ancientPlaceId == 'unknown') ? item.modernPlaceId : item.ancientPlaceId)}">
                            <p-badge class="p-2 pr-0" value="{{item.count}}"></p-badge>
                            <a class="no-underline font-bold">{{(item.modernPlaceLabel != '' || item.ancientPlaceLabel == 'unknown') ? item.modernPlaceLabel : item.ancientPlaceLabel}}</a>
        
                        </li>
                    </ul>
                    <div class="flex align-items-center map-button" *ngIf="{geoData: geoData | async} as map">
                        <button (click)="overlayGeneralMap.toggle($event)" pButton type="button" class="p-button-secondary mr-2"
                            icon="fa-solid fa-map-location-dot" iconPos="left"></button>
        
                        <p-overlayPanel #overlayGeneralMap [appendTo]="'body'">
                            <ng-template pTemplate>
                                <div class="relative mb-3" style="width: 800px;"
                                    *ngIf="{geoData : getGeoData.next((text.groupLocations) || [])} as map">
                                    <div style="height: 600px;" leaflet [leafletOptions]="leafletMapOptions" [leafletLayers]="layers"
                                        [leafletMaxBounds]="bounds">
                                    </div>
                                </div>
                            </ng-template>
                        </p-overlayPanel>
                    </div>
                </div>
        
            </div>


            <!-- TEXTS FILTER BY TYPE -->
            <div id="filter-type-container" class="flex flex-column text-container-top" *ngIf="text.activeTab == 'type'">
                <div class="flex flex-row horizontal-list m-3 text-container-top">
                    <h2 class="loading text-center flex-1 flex align-items-center justify-content-center"
                        *ngIf="!text.groupType">Loading <span>.</span><span>.</span><span>.</span></h2>
        
                    <ul class="flex-wrap align-items-center" *ngIf="text.groupType">
        
                        <li *ngFor="let item of text.groupType" [class.active]="text.activeType == item.inscriptionType"
                            (click)="filterByType(item.inscriptionType)"
                            class="my-2 mr-2 align-items-center border-round-2xl type-list-element" routerLink="./"
                            [queryParams]="{filter: 'type', type: item.inscriptionType | urlDecoder}">
                            <p-badge class="p-2 pr-0" value="{{item.count}}"></p-badge>
                            <a class="no-underline font-bold">{{item.inscriptionType}}</a>
                        </li>
        
        
                    </ul>
                </div>
            </div>
        
            <!-- TEXTS LIST -->
            <div class="flex flex-row flex-wrap ml-5 flex-auto text-item-container" *ngIf="(text.totalRecords != 0 && !somethingWrong) && !text.activeFile">
                <div class="flex flex-row m-2 w-full" *ngIf="!text.totalRecords">
                    <p-progressSpinner class="flex flex-1"></p-progressSpinner>
        
                </div>
        
                <a class="flex no-underline text-item m-2" *ngFor="let item of paginationItems | async"
                    [href]="'/text?file='+item.fileID" routerLink="./" [queryParams]="{file: item.fileID}">

                    <div class="flex flex-row  ">
                        <div class="flex text-item-id p-2">
                            {{item.itAnt_ID}}
                        </div>
        
                        <div class="flex flex-column text-item-preview p-2">
        
                            <div class="text-item-preview-top">
                                {{item.inscriptionTitle != '' ? item.inscriptionTitle : item.itAnt_ID}}
                            </div>
        
                            <div class="text-item-preview-bottom flex flex-column mt-3">
                                <div class="flex flex-row align-items-baseline">
                                    <i class="far fa-calendar-alt"></i>
                                    <span class="ml-2">{{item.dateOfOrigin}}</span>
                                </div>
                                <div class="flex flex-row align-items-baseline mt-2">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span class="ml-2">{{item.originalPlace.ancientName}}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </a>
        
            </div>


            <!-- TEXT VIEW -->
            <div class="flex flex-row flex-wrap flex-auto text-item-container" *ngIf="((text.totalRecords != 0 && !somethingWrong) && text.activeFile) 
                                                                                        && {index : getTextPaginationIndex | async,
                                                                                            fileID: getFileIdByIndex | async, 
                                                                                            file : getFileByIndex | async} as textView">
                
                <div class="flex flex-column flex-auto ">
                    <div [ngClass]="{'zIndex': text.activeFile}" class="flex flex-row horizontal-list m-3 text-container-top sticky top-0">
                        <p-paginator *ngIf="(text.totalRecords != 0 && !somethingWrong)"
                            id="text-view-paginator"
                            [dropdownAppendTo]="'body'" [first]="(textView.index) || 0" [rows]="1"
                            [totalRecords]="(totalRecords | async) || 0"
                            (onPageChange)="textPagination($event)"
                            [showJumpToPageDropdown]="false" 
                            [showPageLinks]="false">
                    
                        </p-paginator>

                        <div id="text-view-id" class="select-none absolute h-full flex justify-content-center align-items-center">
                            
                            <div *ngIf="!textView.file">
                                <i class="fas fa-spinner fa-pulse"></i>
                            </div>
                            <div class="flex flex-column align-items-center" *ngIf="textView.file">
                                <h2 class="font-bold">{{textView.file?.itAnt_ID}}</h2>
                                <h3 class="font-italic font-normal">{{textView.file.inscriptionTitle != '' ? textView.file.inscriptionTitle : textView.file.title}}</h3>
                            </div>
                        </div>

                        
                    </div>         
                    
                    
                    <div class="main-section flex flex-column p-3 m-3" *ngIf="textView.file">

                        <div id="facsimile-div" class="flex flex-column flex-auto pt-3" *ngIf="{facsimile : getFacsimile | async } as images">
                            <!-- <div id="facsimile-div-title" class="flex flex-row">
                                <h2 class="font-medium">Facsimile</h2>
                                
                            </div> -->
                            <div id="facsimile-div-panel" *ngIf="!loadingFacsimile" class="flex ml-3 pt-3 justify-content-center"> 
                            
                                <div class="flex flex-row align-items-baseline book-element pl-2" *ngFor="let img of images.facsimile">
                                    <p-image [src]="img.url" alt="Image" width="250" [preview]="true"></p-image>


                                </div>
                                 
                            </div>
                            <div class="flex flex-row m-2 w-full" *ngIf="loadingFacsimile">
                                <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                    
                            </div>
                        </div> 
                       

                        <!-- TEXT -->

                        <div id="edition-div" class="flex flex-column flex-auto pt-3" *ngIf="{raw : getXMLContent | async } as xml">
                            <div id="edition-div-title" class="flex flex-row">
                                <h2 class="font-medium">Text</h2>
                                
                            </div>

                            <div id="edition-div-panel" class="flex data-list  pt-3" *ngIf="{interpretative: getInterpretativeContent | async,
                                                                                             diplomatic : getDiplomaticContent | async,
                                                                                             annotations: getAnnotations | async,
                                                                                             apparatus : getApparatus | async} as leiden"> 
                                <p-tabView styleClass="text-panel" [hidden]="loadingInterpretative || loadingDiplomatic">
                                    <p-tabPanel header="Intepretative">
                                        <div class="flex flex-row m-2 w-full" *ngIf="loadingInterpretative && loadingDiplomatic">
                                            <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                                
                                        </div>
                                        <div #interpretativeText id="interpretative-text" [hidden]="loadingInterpretative" [innerHTML]="leiden.interpretative | noSanitize " >

                                            
                                        </div>
                                        <div #dynamicOverlay></div>
                                    </p-tabPanel>
                                    <p-tabPanel header="Diplomatic">
                                        <div #diplomaticText id="diplomatic-text" [hidden]="loadingDiplomatic" [innerHTML]="leiden.diplomatic">

                                        </div>
                                    </p-tabPanel>

                                    <p-tabPanel header="Apparatus">
                                        <div #apparatusText id="apparatus-text" class="flex flex-column" [hidden]="loadingApparatus">
                                            <p *ngFor="let app of leiden.apparatus" [innerHTML]="app"></p>
                                        </div>
                                    </p-tabPanel>
    
                                </p-tabView>                              
                                 
                                <div class="grid  print-version">
                                    
                                    <div class="col-6 font-light" >
                                        Interpretative
                                        <div [innerHTML]="leiden.interpretative | noSanitize" ></div>

                                    </div>

                                    
                                    <div class="col-6 font-light">
                                        Diplomatic
                                        <div [innerHTML]="leiden.diplomatic | noSanitize" ></div>

                                    </div>

                                    <div class="col-6 font-light">
                                        Apparatus
                                        <div [innerHTML]="leiden.apparatus" ></div>

                                    </div>
                            
                                </div>
                                
                            </div>
                            <div class="flex flex-row m-2 w-full" *ngIf="loadingInterpretative || loadingDiplomatic">
                                <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                    
                            </div>
                        </div> 
                        
                        
                        <div id="translation-div" class="flex flex-column flex-auto pt-3">
                            <div id="translation-div-title" class="flex flex-row">
                                <h2 class="font-medium">Translation</h2>
                                
                            </div>

                            <div id="translation-div-panel" class="flex data-list" *ngIf="{data: getTranslation | async } as translation"> 

                                <!-- {{translation.data | json}} -->
                                <div *ngIf="!loadingTranslation">

                                    <div class="grid m-3" *ngIf="translation.data.length > 0">
                                        <div class="col-12 lg:col-6 font-light" *ngFor="let trans of translation.data" [innerHTML]="trans">
    
                                        </div>
                                
                                    </div>
    
                                    <div class="font-italic font-light m-3" *ngIf="translation.data.length == 0">
                                        No translation
                                    </div>
                                </div>
                                
                            </div>
                            <div class="flex flex-row m-2 w-full" *ngIf="loadingTranslation">
                                <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                    
                            </div>
                        </div> 

                        <!-- TEXT-DATA -->

                        <div id="text-data-div" class="flex flex-column flex-auto pt-3">
                            <div id="text-data-div-title" class="flex flex-row">
                                <h2 class="font-medium">Text Data</h2>
                                
                            </div>

                            <div class="flex grid data-list pt-3">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Autopsy date:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <span class="font-normal" *ngIf="textView.file.autopsyDate">{{textView.file.autopsyDate}}</span>
                                    <span class="font-italic" *ngIf="textView.file.autopsyDate == undefined">No info</span>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Autopsy author:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <span class="font-normal" *ngIf="textView.file.autopsyAuthor">{{textView.file.autopsyAuthor}}</span>
                                    <span class="font-italic" *ngIf="textView.file.autopsyAuthor == undefined">No info</span>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Language:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column" *ngIf="textView.file.language.length > 0">

                                        <div class="flex flex-column">
                                            <a class="font-bold text-red-800 " *ngFor="let lang of textView.file.language" [href]="lang.source" target="_blank">{{lang.ident}}</a>

                                        </div>
                                        
                                    </div>

                                    <div class="flex flex-column" *ngIf="textView.file.language.length == 0">

                                        <div class="flex flex-column">
                                            <span class="font-italic " >No info</span>

                                        </div>
                                        
                                    </div>
                                </div>
                            </div>


                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Alphabet:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column" *ngIf="textView.file.writingSystem != undefined">

                                        <div class="flex flex-column">
                                            <a class="font-bold text-red-800 " [href]="textView.file.alphabet_url" target="_blank">{{textView.file.writingSystem}}</a>

                                        </div>
                                        
                                    </div>

                                    <div class="flex flex-column" *ngIf="textView.file.alphabet == undefined">

                                        <div class="flex flex-column">
                                            <span class="font-italic " >No info</span>

                                        </div>
                                        
                                    </div>
                                </div>
                            </div>

                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Word division type:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <span class="font-normal" *ngIf="textView.file.wordDivisionType">{{textView.file.wordDivisionType}}</span>
                                    <span class="font-italic" *ngIf="textView.file.wordDivisionType == undefined">No info</span>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Paleographic notes:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <span class="font-normal" *ngIf="textView.file.paleographicNotes">{{textView.file.paleographicNotes}}</span>
                                    <span class="font-italic" *ngIf="textView.file.paleographicNotes == undefined">No info</span>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Inscription type:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <span class="font-normal" *ngIf="textView.file.inscriptionType">{{textView.file.inscriptionType}}</span>
                                    <span class="font-italic" *ngIf="textView.file.inscriptionType == undefined">No info</span>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Execution:</span>
                                </div>
                                <div class="flex flex-column col-9" *ngIf="isBodyTextPartArray">

                                    <div class="flex flex-column mb-3" *ngFor="let ductus of textView.file.bodytextpart">
                                        <div>
                                            <span class="font-bold text-red-800 ">Ductus:</span> <span class="font-normal ">{{ductus.ductus}}</span>
                                        </div>
                                        <div>
                                            <span class="font-bold text-red-800 ">Section:</span> <span class="font-normal ">{{ductus.section}}</span>
                                        </div>
                                        <div>
                                            <span class="font-bold text-red-800 ">Text direction:</span> <span class="font-normal ">{{ductus.textDirection}}</span>
                                        </div>

                                    </div>
                                    
                                </div>

                                <div class="flex flex-column col-9" *ngIf="!isBodyTextPartArray">

                                    <div>
                                        <span class="font-bold text-red-800 ">Ductus:</span> <span class="font-normal ">{{textView.file.bodytextpart.ductus}}</span>
                                    </div>
                                    <div>
                                        <span class="font-bold text-red-800 ">Section:</span> <span class="font-normal ">{{textView.file.bodytextpart.section}}</span>
                                    </div>
                                    <div>
                                        <span class="font-bold text-red-800 ">Text direction:</span> <span class="font-normal ">{{textView.file.bodytextpart.textDirection}}</span>
                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list align-items-baseline">
                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold" [pTooltip]="'Dating certainty: '+textView.file.datingCertainty" tooltipPosition="top">Date<sup><i class="fa-solid fa-question fa-2xs"></i></sup>:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <span class="font-normal">{{textView.file.dateOfOrigin != undefined ? textView.file.dateOfOrigin : 'No info'}}</span>
                                    
                                    
                                </div>
                            </div>
                            
                        </div> 

                         <!-- SUPPORT -->

                        <div id="text-data-div" class="flex flex-column flex-auto pt-3">
                            <div id="text-data-div-title" class="flex flex-row">
                                <h2 class="font-medium">Support</h2>
                                
                            </div>

                            <div class="flex grid data-list pt-3" *ngIf="textView.file.support.objectType != undefined">

                                <div class="flex col-3 justify-content-end" >
                                    <span class="font-bold text-right">Object type:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <a class="font-bold text-red-800 " [href]="textView.file.support.objectType_conceptUrl" target="_blank">{{textView.file.support.objectType}}</a>

                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list" *ngIf="textView.file.support.material != undefined">

                                <div class="flex col-3 justify-content-end" >
                                    <span class="font-bold ">Material:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <a class="font-bold text-red-800 " [href]="textView.file.support.material_conceptUrl" target="_blank">{{textView.file.support.material}}</a>

                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list" *ngIf="textView.file.dimensions != undefined">

                                <div class="flex col-3 justify-content-end" >
                                    <span class="font-bold text-right">Dimensions:</span>
                                </div>
                                <div class="flex flex-column col-9">

                                    <div>
                                        <span class="font-bold text-red-800 " *ngIf="textView.file.dimensions.width != ''">Width:</span> <span class="font-normal pl-3">{{textView.file.dimensions.width}} c.m.</span>
                                    </div>
                                    <div>
                                        <span class="font-bold text-red-800 " *ngIf="textView.file.dimensions.height != ''">Height:</span> <span class="font-normal pl-3">{{textView.file.dimensions.height}} c.m.</span>
                                    </div>
                                    <div>
                                        <span class="font-bold text-red-800 " *ngIf="textView.file.dimensions.depth != ''">Depth:</span> <span class="font-normal pl-3">{{textView.file.dimensions.depth}} c.m.</span>
                                    </div>
                                </div>
                            </div>

                            <div class="flex grid data-list" *ngIf="textView.file.layoutNotes != undefined">

                                <div class="flex col-3 justify-content-end" >
                                    <span class="font-bold text-right">Layout notes:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <span class="font-normal" *ngIf="textView.file.layoutNotes != ''">{{textView.file.layoutNotes}}</span>
                                        <span class="font-italic" *ngIf="textView.file.layoutNotes == ''">No info</span>

                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list">

                                <div class="flex col-3 justify-content-end" *ngIf="textView.file.condition != undefined">
                                    <span class="font-bold text-right">Condition:</span>
                                </div>
                                <div class="flex flex-column col-9">

                                    <div class="flex flex-column">
                                        <span class="font-normal" *ngIf="textView.file.condition != ''">{{textView.file.condition}}</span>
                                        <span class="font-italic" *ngIf="textView.file.condition == ''">No info</span>

                                    </div>

                                    <div class="flex flex-column" *ngIf="textView.file.conditionDesc != undefined">
                                        <span class="font-normal" *ngIf="textView.file.conditionDesc != ''">{{textView.file.conditionDesc}}</span>
                                        <span class="font-italic" *ngIf="textView.file.conditionDesc == ''">No info</span>

                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list" *ngIf="textView.file.decoration != undefined">

                                <div class="flex col-3 justify-content-end" >
                                    <span class="font-bold text-right">Decoration:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <span class="font-normal" *ngIf="textView.file.decoration != ''">{{textView.file.decoration}}</span>
                                        <span class="font-italic" *ngIf="textView.file.decoration == ''">No info</span>

                                    </div>
                                    
                                </div>
                            </div>
                            
                        </div> 

                        <!-- ORIGIN AND CONSERVATION -->


                        <div id="text-data-div" class="flex flex-column flex-auto pt-3">
                            <div id="text-data-div-title" class="flex flex-row">
                                <h2 class="font-medium">Origin and Preservation</h2>
                                
                            </div>

                            <div class="flex grid data-list pt-3" *ngIf="textView.file.originalPlace.ancientName != undefined">

                                <div class="flex col-3 justify-content-end" *ngIf="textView.file.originalPlace.ancientName != ''">
                                    <span class="font-bold text-right">Ancient find spot name:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <a class="font-bold text-red-800 " [href]="textView.file.originalPlace.ancientNameUrl" target="_blank">{{textView.file.originalPlace.ancientName}}</a>

                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list pt-3" *ngIf="textView.file.originalPlace.modernName != undefined">

                                <div class="flex col-3 justify-content-end" *ngIf="textView.file.originalPlace.modernName != ''">
                                    <span class="font-bold text-right">Modern find spot name:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <a class="font-bold text-red-800 " [href]="textView.file.originalPlace.modernNameUrl" target="_blank">{{textView.file.originalPlace.modernName}}</a>

                                    </div>
                                    
                                </div>
                            </div>


                            <div class="flex grid data-list pt-3" *ngIf="textView.file.discoveryYear != undefined">

                                <div class="flex col-3 justify-content-end">
                                    <span class="font-bold text-right">Discovery year:</span>
                                </div>
                                <div class="flex flex-column col-9">

                                    <div>
                                        <span class="font-bold text-red-800 " *ngIf="textView.file.discoveryYear.when != ''">When:</span> <span class="font-normal ">{{textView.file.discoveryYear.when}}</span>
                                    </div>
                                    <div>
                                        <span class="font-bold text-red-800 " *ngIf="textView.file.discoveryYear.notAfter != ''">Not after:</span> <span class="font-normal ">{{textView.file.discoveryYear.notAfter}}</span>
                                    </div>
                                    <div>
                                        <span class="font-bold text-red-800 " *ngIf="textView.file.discoveryYear.notBefore != ''">Not before:</span> <span class="font-normal ">{{textView.file.discoveryYear.notBefore}}</span>
                                    </div>
                                </div>
                            </div>


                            <div class="flex grid data-list pt-3" *ngIf="textView.file.settlement.placeOfConservation != undefined">

                                <div class="flex col-3 justify-content-end" *ngIf="textView.file.settlement.placeOfConservation != ''">
                                    <span class="font-bold text-right">Place of conservation:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <a class="font-bold text-red-800 " [href]="textView.file.settlement.placeOfConservationExternalReference" target="_blank">{{textView.file.settlement.placeOfConservation}}</a>

                                    </div>
                                    
                                </div>
                            </div>


                            <div class="flex grid data-list pt-3" *ngIf="textView.file.conservationInstitution != undefined">

                                <div class="flex col-3 justify-content-end" *ngIf="textView.file.conservationInstitution.name != ''">
                                    <span class="font-bold text-right">Conservation institution:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <a class="font-bold text-red-800 " [href]="textView.file.conservationInstitution.URL" target="_blank">{{textView.file.conservationInstitution.name}}</a>

                                    </div>
                                    
                                </div>
                            </div>

                            <div class="flex grid data-list" *ngIf="textView.file.inventoryNumber != undefined">

                                <div class="flex col-3 justify-content-end" >
                                    <span class="font-bold text-right">Inventory number:</span>
                                </div>
                                <div class="flex flex-row col-9">

                                    <div class="flex flex-column">
                                        <span class="font-normal" *ngIf="textView.file.inventoryNumber != ''">{{textView.file.inventoryNumber}}</span>
                                        <span class="font-italic" *ngIf="textView.file.inventoryNumber == ''">No info</span>

                                    </div>
                                    
                                </div>
                            </div>
                        </div> 

                        <div id="commentary-div" class="flex flex-column flex-auto pt-3" *ngIf="{data : getCommentary | async } as commentary">
                            <div id="facsimile-div-title" class="flex flex-row">
                                <h2 class="font-medium">Commentary</h2>
                                
                            </div>
                            <div id="facsimile-div-panel" *ngIf="!loadingCommentary" class="flex ml-3 pt-3 justify-content-center"> 
                            
                                <div class="flex flex-column align-items-baseline pl-2" *ngIf="commentary.data && commentary.data.length > 0">
                                   
                                    <p class="font-normal pb-3" *ngFor="let note of commentary.data" [innerHTML]="note | noSanitize"></p>
                                </div>

                                <div class="flex flex-column align-items-baseline pl-2" *ngIf="commentary.data && commentary.data.length == 0">
                                   
                                    <p class="font-italic font-light pb-3">No info</p>
                                </div>
                                 
                            </div>
                            <div class="flex flex-row m-2 w-full" *ngIf="loadingCommentary">
                                <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                    
                            </div>
                        </div>

                        <!-- <div id="apparatus-div" class="flex flex-column flex-auto pt-3" *ngIf="{data : getApparatus | async } as apparatus">
                            <div id="apparatus-div-title" class="flex flex-row">
                                <h2 class="font-medium">Apparatus</h2>
                                
                            </div>
                            <div id="apparatus-div-panel" *ngIf="!loadingApparatus" class="flex ml-3 pt-3 justify-content-center"> 
                            
                                <div class="flex flex-column align-items-baseline pl-2" *ngIf="apparatus.data && apparatus.data.length > 0">
                                   
                                    <p class="font-normal pb-3" *ngFor="let note of apparatus.data" [innerHTML]="note | noSanitize"></p>
                                </div>

                                <div class="flex flex-column align-items-baseline pl-2" *ngIf="apparatus.data && apparatus.data.length == 0">
                                   
                                    <p class="font-italic font-light pb-3">No info</p>
                                </div>
                                 
                            </div>
                            <div class="flex flex-row m-2 w-full" *ngIf="loadingApparatus">
                                <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                    
                            </div>
                        </div> -->

                        <!-- BIBLIOGRAPHY -->


                        <div id="bibliography-div" class="flex flex-column flex-auto pt-3" *ngIf="{books : getBibliography | async } as bibliography">
                            <div id="bibliography-div-title" class="flex flex-row">
                                <h2 class="font-medium">Bibliography</h2>
                                
                            </div>
                            <div id="bibliography-div-panel" *ngIf="!loadingBibliography" class="flex flex-column ml-3 pt-3"> 
                            
                                <div class="flex flex-row align-items-baseline book-element" *ngFor="let book of bibliography.books">
                                    <i class="fa-solid fa-circle fa-2xs"></i>
                                    <a class="font-bold ml-3 no-underline" [href]="book.url" target="_blank">
                                        <span class="font-bold text-red-800">{{book.title}}</span>
                                        <span class="font-normal text-900 pl-2" *ngIf="book.author != undefined">({{book.author.name}} {{book.author.surname}})</span>
                                        <span class="font-normal text-900 pl-2" *ngIf="book.editor != undefined && book.author == undefined">({{book.editor.name}} {{book.editor.surname}})</span>
                                    </a>

                                </div>
                                 
                            </div>
                            <div class="flex flex-row m-2 w-full" *ngIf="loadingBibliography">
                                <p-progressSpinner class="flex flex-1"></p-progressSpinner>
                    
                            </div>
                        </div> 


                        
                    </div>
                    

                   
                    
                </div>
                <div class="flex flex-row m-2 w-full" *ngIf="!textView.file">
                    <p-progressSpinner class="flex flex-1"></p-progressSpinner>
        
                </div>
            </div>
        
            <p-paginator *ngIf="(text.totalRecords != 0 && !somethingWrong) && !text.activeFile" [dropdownAppendTo]="'body'" [first]="first" [rows]="rows"
                [totalRecords]="(totalRecords | async) || 0"
                (onPageChange)="pagination($event, (text.activeTab || null), (text.activeDate || null), (text.activeLocation || null), (text.activeType || null))"
                [showJumpToPageDropdown]="true" [rowsPerPageOptions]="[6,12,24]"></p-paginator>
            
                
            <div class="m-5 flex flex-row flex-wrap flex-auto text-item-container" *ngIf="text.totalRecords == 0 && !somethingWrong">
                no entries
            </div>

            <div class="m-5 flex flex-row flex-wrap flex-auto text-item-container" *ngIf="somethingWrong">
                Something went wrong
            </div>
        </div>

</div>

